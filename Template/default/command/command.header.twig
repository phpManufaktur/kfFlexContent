{#
  flexContent

  @author Team phpManufaktur <team@phpmanufaktur.de>
  @link https://kit2.phpmanufaktur.de
  @link https://github.com/phpManufaktur/kitFramework/wiki
  @copyright 2014 Ralf Hertsch <ralf.hertsch@phpmanufaktur.de>
  @license MIT License (MIT) http://www.opensource.org/licenses/MIT
#}
{% if parameter.load_css %}
  <script type="text/javascript">
    (function() {
      {% if parameter.check_jquery is defined and parameter.check_jquery %}
        if (!window.jQuery) {
          alert("{{'flexContent is missing jQuery - please add the parameter library[jquery/jquery/1.10.2/jquery.min.js] to the kitCommand at this page.'|trans }}");
        }
        else {
          var jq = document.createElement('script');
          jq.setAttribute('type', 'text/javascript');
          jq.setAttribute('src', '{{ LIBRARY_URL ~ '/bootstrap/3.1.0/js/bootstrap.min.js'}}');
          document.getElementsByTagName('head')[0].appendChild(jq);
        }
      {% endif %}  

      function getBasename(path) {
        return path.replace( /.*\//, "" );
      }
      
      function cssAlreadyLoaded(css_url) {
        var styleSheets = document.styleSheets;
        var cssFile = getBasename(css_url);
        for (var i = 0, max = styleSheets.length; i < max; i++) {
          var sheetURL = styleSheets[i].href;
          var basename = getBasename(sheetURL);
          if ((sheetURL === css_url) || (basename === cssFile)) {
            return true;
          }
        }
        return false;
      }
      
      if (!cssAlreadyLoaded('{{ LIBRARY_URL ~ '/bootstrap/3.1.0/css/bootstrap.min.css' }}')) {
        var css = document.createElement('link');
        css.setAttribute('rel', 'stylesheet');
        css.setAttribute('type', 'text/css');
        css.setAttribute('media', 'all');
        css.setAttribute('href', '{{ LIBRARY_URL ~ '/bootstrap/3.1.0/css/bootstrap.min.css' }}');
        document.getElementsByTagName('head')[0].appendChild(css);
      }

      if (!cssAlreadyLoaded('{{ LIBRARY_URL ~ '/font-awesome/4.0.3/css/font-awesome.min.css' }}')) {  
        var css = document.createElement('link');
        css.setAttribute('rel', 'stylesheet');
        css.setAttribute('type', 'text/css');
        css.setAttribute('media', 'all');
        css.setAttribute('href', '{{ LIBRARY_URL ~ '/font-awesome/4.0.3/css/font-awesome.min.css' }}');
        document.getElementsByTagName('head')[0].appendChild(css);
      }

      if (!cssAlreadyLoaded('{{ MANUFAKTUR_URL ~ '/flexContent/Template/default/css/flexcontent.min.css' }}'))  {
        var css = document.createElement('link');
        css.setAttribute('rel', 'stylesheet');
        css.setAttribute('type', 'text/css');
        css.setAttribute('media', 'all');
        {% if fileExists(MANUFAKTUR_PATH ~ '/flexContent/Template/' ~ FRAMEWORK_TEMPLATES.0 ~ '/css/flexcontent.min.css') %}
          css.setAttribute('href', '{{ MANUFAKTUR_URL ~ '/flexContent/Template/' ~ FRAMEWORK_TEMPLATES.0 ~ '/css/flexcontent.min.css' }}');
        {% else %}
          css.setAttribute('href', '{{ MANUFAKTUR_URL ~ '/flexContent/Template/default/css/flexcontent.min.css' }}');
        {% endif %}
        document.getElementsByTagName('head')[0].appendChild(css);
      }
    })();
  </script>
{% endif %}
